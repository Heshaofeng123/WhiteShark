<!doctype html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<!--标准mui.css-->
		<link href="css/mui.min.css" rel="stylesheet" />
		<!--App自定义的css-->
		<link rel="stylesheet" href="css/home.css" />
		<link rel="stylesheet" href="css/app.css" />
		<style>
			.top_page {
				margin: 0;
				padding: 0;
			}
			
			.top_right {
				margin: 0;
				padding: 0;
			}
			
			.list1 {
				overflow: hidden;
				padding: 10px;
				border-bottom: 1px solid #DDDDDD;
			}
			
			.list1 .list_pic {
				overflow: hidden;
				margin: 10px 0;
				width: 90px;
				height: 90px;
			}
			
			.bottom_page {
				margin: 0;
				padding: 0;
				float: left;
				width: 56%;
			}
			
			.bottom_page .bottom_context {
				padding-top: 15px;
			}
			
			.bottom_page_right {
				/*margin: 0;*/
				margin: 15px, 5px, 0;
				float: right;
			}
			
			.list2-list {
				overflow: hidden;
				padding: 10px;
				border-bottom: 1px solid #DDDDDD;
			}
			
			.list2-left h2 {
				font-size: 1.2rem;
				color: #666666;
				line-height: 1.6rem;
				margin: 0;
			}
			
			.list2-left {
				float: left;
				width: 56%;
			}
			
			.list2-left h2 {
				height: 4.8rem;
			}
			
			.list2-left p {
				overflow: hidden;
				padding: 0;
				text-indent: 0;
				font-size: 0.6rem;
				line-height: 0.6rem;
				margin: 10px 0;
			}
			
			.list2-left p span {
				margin-left: 10px;
			}
			
			.list2-left p span:first-child {
				margin-left: 0;
			}
			
			.list2-list img {
				float: right;
				width: 40%;
				height: 6.4rem;
			}
			
			.card3_img {
				width: 93px;
				height: 100px;
			}
		</style>
	</head>

	<body>
		<!--<header class="mui-bar mui-bar-nav" style="background: white;">
			<!--<h1 class="logo">华地资讯</h1>
			<a class="search" href="search.html">搜索你想要的商品</a>
			<h1 class="mui-title">华地艺术</h1>
			<!--<button id="submit" class="mui-btn mui-btn-blue mui-btn-link mui-pull-right">发送</button>
			<img id="search" class="mui-action-back mui-icon mui-icon-left-nav mui-pull-right" src="../images/search.png>
			
			
		</header>-->

		<header class="yiheader">
			<!--<button id="submit" class="mui-btn mui-btn-blue mui-btn-link mui-pull-right">发送</button>-->
			<h1 class="logos">华地艺术资讯</h1>
			<div class="search-box" id="search">
				<a href="search.html" class="search"></a>
			</div>

		</header>

		<div class="mui-content">
			<div id="slider" class="mui-slider mui-fullscreen">
				<div id="sliderSegmentedControl" class="mui-scroll-wrapper mui-slider-indicator mui-segmented-control mui-segmented-control-inverted">
					<div class="mui-scroll mui-scroll-wrapper">
						<a class="mui-control-item mui-active" href="#item1mobile">
							头条
						</a>
						<a class="mui-control-item" href="#item2mobile">
							艺术家
						</a>
						<a class="mui-control-item" href="#item3mobile">
							书画
						</a>
						<a class="mui-control-item" href="#item4mobile">
							艺术品
						</a>
						<a class="mui-control-item" href="#item5mobile">
							访谈
						</a>
						<a class="mui-control-item" href="#item6mobile">
							古玩
						</a>
						<a class="mui-control-item" href="#item7mobile">
							展览
						</a>
						<a class="mui-control-item" href="#item8mobile">
							艺术市场
						</a>
						<a class="mui-control-item" href="#item9mobile">
							收藏品
						</a>
					</div>
				</div>
				<!--<div id="sliderProgressBar" class="mui-slider-progress-bar mui-col-xs-2"></div>-->
				<div class="mui-slider-group">
					<div id="item1mobile" class="mui-slider-item mui-control-content mui-active">

						<div id="scroll1" class="mui-scroll-wrapper">

							<div class="mui-scroll">
								<ul id="list0" class="mui-table-view">
									<!--<div class="banner"><img src="images/banner.png"></div>-->

									<!--<div class="card1">
										<a href="info.html">
										<div class="card_tit">
											<p class="card_time"><em></em><span>2015.6.23  15：00</span></p>
											<p class="card_Source">华地艺术网专稿</p>
										</div>
										<div class="card1_nr">
											<div class="card1_pic">
												<img src="images/pic1.png">
												<img src="images/pic2.png">
												<img src="images/pic1.png">
											</div>
											<h2>
												墨西哥写实绘画艺术家Omar Ortiz
											</h2>
										</div>
										<div class="card_number">
											<p class="card_xi">
												<em></em>
												<span>324</span>
											</p>
											<p class="card_du">
												<em></em>
												<span>324</span>
											</p>
										</div>
										</a>
									</div>
									
									<div class="card2">
										<a href="info.html">
										<div class="card_tit">
											<p class="card_time"><em></em><span>2015.6.23  15：00</span></p>
											<p class="card_Source">华地艺术网专稿</p>
										</div>
										<div class="card2_nr">
											<div class="card2_pic">
												<img src="images/pic3.png">
											</div>
											<h2>
												墨西哥写实绘画艺术家Omar Ortiz
											</h2>
										</div>
										<div class="card_number">
											<p class="card_xi">
												<em></em>
												<span>324</span>
											</p>
											<p class="card_du">
												<em></em>
												<span>324</span>
											</p>
										</div>
										</a>
									</div>
									
									
									<div class="card3">
										<a href="info.html">
										<div class="card_tit">
											<p class="card_time"><em></em><span>2015.6.23  15：00</span></p>
											<p class="card_Source">华地艺术网专稿</p>
										</div>
										<div class="card3_nr">
											<div class="card3_tit">
												<h2>
													墨西哥写实绘画艺术家Omar Ortiz
												</h2>
												<p>在冉劲松的画前，观赏品味他这些年来的油画作品，他能不为流俗所累，抗拒潮流，在写实主义的崎岖小道上踽踽独行，这需要怎样的一种心境？他有世俗的忧伤，有对于平凡人的关爱，有对于弱势群体和无助者们的深切同情。</p>
											</div>
											<div class="card3_pic">
												<img src="images/pic2.png">
											</div>
										</div>
										<div class="card_number">
											<p class="card_xi">
												<em></em>
												<span>324</span>
											</p>
											<p class="card_du">
												<em></em>
												<span>324</span>
											</p>
										</div>
										</a>
									</div>-->

								</ul>
							</div>
						</div>
					</div>
					<div id="item2mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list1" class="mui-table-view">
								</ul>
							</div>
						</div>
					</div>
					<div id="item3mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list2" class="mui-table-view">
								</ul>
							</div>
						</div>
					</div>
					<div id="item4mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list3" class="mui-table-view">
								</ul>
							</div>
						</div>
					</div>
					<div id="item5mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list4" class="mui-table-view">
								</ul>
							</div>
						</div>
					</div>
					<div id="item6mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list5" class="mui-table-view">
								</ul>
							</div>
						</div>
					</div>
					<div id="item7mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list6" class="mui-table-view">
								</ul>
							</div>
						</div>
					</div>
					<div id="item8mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list7" class="mui-table-view">
								</ul>
							</div>
						</div>
					</div>
					<div id="item9mobile" class="mui-slider-item mui-control-content">
						<div class="mui-scroll-wrapper">
							<div class="mui-scroll">
								<ul id="list8" class="mui-table-view">

								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<input type="hidden" id="idvalue"/>
		<script src="js/mui.min.js"></script>
		<script src="js/mui.pullToRefresh.js"></script>
		<script src="js/mui.pullToRefresh.material.js"></script>
		<!--<script src="js/home.js"></script>-->
		<script src="js/common.js"></script>

		<script>
			mui.init();
					
			(function($) {
				var deceleration = mui.os.ios ? 0.003 : 0.0009;
				$('.mui-scroll-wrapper').scroll({
					bounce: false,
					indicators: true, //是否显示滚动条
					deceleration: deceleration
				});
			
				var createFragment = function(ul, index, data, reverse) {
					
//				alert("样式展示");
					var fragment = document.createDocumentFragment();
					var li;
					console.log("dasfas   "+JSON.stringify(data))
					for(var i = 0; i < data.result.length; i++) {
						//获取服务器传输过来的值→详情界面
						mui(".mui-slider-group .mui-scroll").on('tap','mui-table-view-cell mui-media',function(){
						  //获取id
						  var id = this.getAttribute(data.result[i].id);
						  var likes = this.getAttribute(data.result[i].likes);
						  var deburl = this.getAttribute(data.result[i].deburl);
						  //传值给详情页面，通知加载新数据
//						  mui.fire(detail,'getDetail',{id:id});
						  //打开新闻详情
						  mui.openWindow({
						     extras:{
						     	likes:likes,
						     	id:id,
						     	deburl:deburl,
						     }
						  });
						}) 
						
						li = document.createElement('li');
						var num = Math.round(Math.random()*2+1);
						if(num == 1) {
							li.className = 'mui-table-view-cell mui-media';
							li.innerHTML = '<div class="card1"><a href="info.html"><div class="card_tit"><p class="card_time"><em></em><span>' + (data.result[i].addtime) + '</span></p><p class="card_Source">华地艺术网专稿</p></div><div class="card1_nr"><div class="card1_pic"><img src= http://' + (data.result[i].arr[1]) + '><img src=http://' + (data.result[i].arr[2]) + '><img src=http://' + (data.result[i].arr[3]) + '></div><h2>' + data.result[i].introduce + '</h2></div><div class="card_number"><p class="card_xi"><em></em><span>' + (data.result[i].hits) + '</span></p><p class="card_du"><em></em><span>' + (data.result[i].likes) + '</span></p></div></a></div>'
						} else if(num == 2) {
							//卡片2
							li.className = 'mui-table-view-cell mui-media';
							li.innerHTML = '<div class="card2"><a href="info.html"><div class="card_tit"><p class="card_time"><em></em><span>' + (data.result[i].addtime) + '</span></p><p class="card_Source">华地艺术网专稿</p></div><div class="card2_nr"><div class="card2_pic"><img src=http://' + (data.result[i].arr[1]) + '></div><h2>' + data.result[i].introduce + '</h2></div><div class="card_number"><p class="card_xi"><em></em><span>' + (data.result[i].hits) + '</span></p><p class="card_du"><em></em><span>' + (data.result[i].likes) + '</span></p></div></a></div>'
						} else {
							//卡片3
							li.className = 'mui-table-view-cell mui-media';
							li.innerHTML = '<div class="card3"><a href="info.html"><div class="card_tit"><p class="card_time"><em></em><span>' + (data.result[i].addtime) + '</span></p><p class="card_Source">华地艺术网专稿</p></div><div class="card3_nr"><div class="card3_tit"><h2>' + data.result[i].introduce + '</h2><p>' + data.result[i].introduce + '</p></div><div class="card3_pic"><img src=http://' + (data.result[i].arr[1]) + '></div></div><div class="card_number"><p class="card_xi"><em></em><span>' + (data.result[i].hits) + '</span></p><p class="card_du"><em></em><span>' + (data.result[i].likes) + '</span></p></div></a></div>'
						}
						fragment.appendChild(li);
						Common.closeWaiting(waiting);
					}
					return fragment;
				};
				var latestId;
				var waiting;
				var tab_type = 1;//ul, index, reverse, page
				var agnix = function(ul, index, reverse,page, id) {
					var type_index = catidWithIndex(index);
					var data;
					if(reverse) {
						data = {
							type: type_index,
							subtype: 0,
							page: page,
							id: id,
							action: "referesh",
						}

					} else {
						data = {
							type: type_index,
							subtype: 0,
							page: page,
						}
					}
					mui.ajax('http://192.168.0.112/fuwu/api/article.php', {
						data: data,
						dataType: 'json', //服务器返回json格式数据
						
						
						type: 'post', //HTTP请求类型
						timeout: 10000, //超时时间设置为10秒；
						success: function(data) {
							console.log('success:::' + JSON.stringify(data.result));
//							
							if(data.status == "200"){
								if(reverse) {
									ul.insertBefore(createFragment(ul, index, data, true), ul.firstChild);
									} else {
									ul.appendChild(createFragment(ul, index, data));
									}
								}
							Common.closeWaiting(waiting);
						},
						error: function(xhr, type, errorThrown) {
							alert(100);
							Common.closeWaiting(waiting);
						}
					});
				};
				
				 
				
				var catidWithIndex = function(index) {
					var catid;
					switch(index) {
						case 0:
							{
								catid = 1; //头条
							}
							break;
						case 1:
							{
								catid = 2; //艺术家
							}
							break;
						case 2:
							{
								catid = 3; //书画
							}
							break;
						case 3:
							{
								catid = 4; //艺术品
							}
							break;
						case 4:
							{
								catid = 5; //访谈
							}
							break;
						case 5:
							{
								catid = 6; //古玩
							}
							break;
						case 6:
							{
								catid = 7; //展览
							}
							break;
						case 7:
							{
								catid = 8; //艺术市场
							}
							break;
						case 8:
							{
								catid = 9; //收藏品
							}
							break;
						default:
							break;
					}
					return catid;
				};
				var page0 = 1;
				var page1 = 1;
				var page2 = 1;
				var page3 = 1;
				var page4 = 1;
				var page5 = 1;
				var page6 = 1;
				var page7 = 1;
				var page8 = 1;
				var pageWithReverseAndIndex = function(index) {
					var page;
					switch(index) {
						//推荐
						case 0:
							{
								page0++;
								page = page0;
							}
							break;
							//热点
						case 1:
							{
								page1++;
								page = page1;
							}
							break;
							//上海
						case 2:
							{
								page2++;
								page = page2;
							}
							break;
							//社会
						case 3:
							{
								page3++;
								page = page3;
							}
							break;
							//娱乐
						case 4:
							{
								page4++;
								page = page4;
							}
							break;
							//科技
						case 5:
							{
								page5++;
								page = page5;
							}
							break;
						case 6:
							{
								page6++;
								page = page6; //展览
							}
							break;
						case 7:
							{
								page7++;
								page = page7; //艺术市场
							}
							break;
						case 8:
							{
								page8++;
								page = page8; //收藏品
							}
							break;
						default:
							break;
							
					}
					return page;
				};

				mui.plusReady(function() {
					waiting = Common.showWaiting();
					
					mui('.mui-slider-group .mui-table-view').each(function(index, element) {
						agnix(element, index, 0, 0,1);
						mui('#list' + (index) + '').on('tap', 'a', function() {
							var id = this.getAttribute('id');
							var href = this.href;
							var type = this.getAttribute("open-type");
							mui.openWindow({
								id: id,
								url: this.href,
								styles: {
									popGesture: 'close',
								},
								createNew: false //是否重复创建同样id的webview，默认为false:不重复创建，直接显示
							});
						});
					})
				});
					
				$.ready(function() {
					//循环初始化所有下拉刷新，上拉加载。
					$.each(document.querySelectorAll('.mui-slider-group .mui-scroll'), function(index, pullRefreshEl) {
						$(pullRefreshEl).pullToRefresh({
							down: {
								callback: function() {
									var self = this;
									setTimeout(function() {
										var ul = self.element.querySelector('.mui-table-view');
										var page = pageWithReverseAndIndex(index);
										agnix(ul, index, true,1);
										self.endPullDownToRefresh();
									}, 1000);
								}
							},
							up: {
								callback: function() {
									var self = this;
									setTimeout(function() {
										var ul = self.element.querySelector('.mui-table-view');
										var page = pageWithReverseAndIndex(index);
										latestId=document.getElementById("idvalue").value;
										agnix(ul, index, false, page,latestId);
										self.endPullUpToRefresh();
									}, 1000);
								}
							}
						});
					});	
				});
			})(mui);
		</script>

	</body>

</html>